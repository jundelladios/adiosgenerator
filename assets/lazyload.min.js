(function() {
  function WebGeneratorFireLazyLoaders() {

    const lazyElements = document.querySelectorAll('img[data-src], iframe[data-src]');
    const observerElements = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const element = entry.target;
          element.src = element.dataset.src; // Load the actual resource
          observerElements.unobserve(element); // Stop observing after loading
        }
      });
    });

    lazyElements.forEach(element => {
      observerElements.observe(element); // Start observing each element
    });

    const lazyBackgrounds = document.querySelectorAll('.et_pb_section');
    const observerBackgrounds = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const bgElement = entry.target;
          bgElement.classList.add('loaded');
          observerBackgrounds.unobserve(bgElement);
        }
      });
    }, {
      threshold: 0.1  // Trigger when 10% of the element is in the viewport
    });
    
    lazyBackgrounds.forEach(element => {
      observerBackgrounds.observe(element);
    });
  }

  // To add this script in HTML, place the following in your HTML file, preferably before the closing </body> tag:
  // <script src="path/to/lazyload.min.js"></script>
  // Or, if you want to inline it, wrap the code above in <script> ... </script>
  document.addEventListener('DOMContentLoaded', function() {
    WebGeneratorFireLazyLoaders();
  });
})();